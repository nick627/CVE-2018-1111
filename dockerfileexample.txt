#//https://askubuntu.com/questions/938700/how-do-i-install-docker-on-ubuntu-16-04-lts
#sudo apt-get install -y  docker.io
#apt-get install -y docker-compose

#//docker ls
#https://docs.docker.com/engine/reference/commandline/container_ls/

#//////////////////////////////////////////////////
#https://qiita.com/Kentakuma/items/51c93322349513cca7ec

# https://qiita.com/Kentakuma/items/51c93322349513cca7ec
# https://goblincoding.com/2018/03/01/docker-systemctl-failed-to-get-d-bus-connection-operation-not-permitted/

###########################################################

# Recommendation

# Dockerfile to build NetworkManager1.8.0-11.el7_4.x86_64 container images
# For CVE 2018-1111
# Based on CentOS

# To run this dockerfile you need to enter the following command:

# Create Environment - port, demon NetworkManager, 
# sudo docker build -t <name_dockerfile> .
#
# Create Image for run docker image
# sudo docker run --privileged -d -p 80:80 --name <name_commit> <name_dockerfile>:latest /sbin/init
#
# Run docker image
# sudo docker exec -it <name_commit> bash

# See docker images
# sudo docker ps
# sudo docker images
#
# Remove docker image
# sudo docker kill <name_commit>
# sudo docker rm <name_commit>


# E.g.
# sudo docker build -t dockerfile .
# sudo docker run --privileged -d -p 80:80 --name test1 dockerfile:latest /sbin/init
# sudo docker exec -it test1 bash

# sudo docker kill test1
# sudo docker rm test1

# End Recommendation

###########################################################

# Set the base image to Centos
FROM centos:7.4.1708

# File Author / Maintainer
MAINTAINER neliseev

ENTRYPOINT ["/usr/sbin/init"]

CMD ["systemctl"]

CMD echo Helllo

RUN yum install -y wget
RUN yum install -y rpm

RUN wget ftp://bo.mirror.garr.it/1/centos/RPM-GPG-KEY-CentOS-7
RUN rpm --import RPM-GPG-KEY-CentOS-7

RUN yum -y install net-tools.x86_64
RUN yum install -y iproute

RUN wget ftp://bo.mirror.garr.it/1/slc/centos/7.1.1503/updates/x86_64/Packages/NetworkManager-1.8.0-11.el7_4.x86_64.rpm

#RUN yum install -y wpa_supplicant-2.6-9.el7.x86_64
RUN yum install -y jansson-2.10-1.el7.x86_64
RUN yum install -y libndp-1.2-7.el7.x86_64
RUN wget ftp://bo.mirror.garr.it/1/slc/centos/7.1.1503/updates/x86_64/Packages/NetworkManager-libnm-1.8.0-11.el7_4.x86_64.rpm
RUN yum install -y NetworkManager-libnm-1.8.0-11.el7_4.x86_64.rpm 
RUN yum install -y NetworkManager-1.8.0-11.el7_4.x86_64.rpm

RUN yum install -y nmap-ncat.x86_64

CMD systemctl start NetworkManager

RUN yum install -y git

RUN echo test11231

RUN echo well

#ENTRYPOINT ["/usr/bin/"]

RUN git clone https://github.com/nick627/CVE2018_11111.git

# cd CVE2018_11111
#WORKDIR /CVE2018_11111

RUN chmod +x CVE2018_11111/settings.sh

CMD ["CVE2018_11111/settings.sh"]

#RUN nmcli

# Again, no need to expose port 80, it is used as part of the
# example implementation
EXPOSE 80

RUN cat /etc/redhat-release

#RUN yum update

#RUN uname -a
#RUN cat /etc/system-release
#CMD echo Hello world

###############################
#yum install -y wget
#wget ftp://bo.mirror.garr.it/1/slc/centos/7.1.1503/updates/x86_64/Packages/NetworkManager-1.8.0-11.el7_4.x86_64.rpm
#yum install -y jansson-2.10-1.el7.x86_64
#yum install -y libndp-1.2-7.el7.x86_64
#wget ftp://bo.mirror.garr.it/1/slc/centos/7.1.1503/updates/x86_64/Packages/NetworkManager-libnm-1.8.0-11.el7_4.x86_64.rpm
#yum install -y NetworkManager-libnm-1.8.0-11.el7_4.x86_64.rpm 

#yum install -y NetworkManager-1.8.0-11.el7_4.x86_64.rpm

#yum -y install net-tools.x86_64
#yum install -y iproute

#systemctl start NetworkManager
